/*
ytSlider heqing0712@126.com
Date:2015-03-02 15:16:29
*/
; (function (b, c, d) { var a = function (f) { if (!f) { return } if (typeof f === "string" || f.nodeType) { f = { idBox: f } } var g = a.defaults; for (var e in g) { (f[e] === d) && (f[e] = g[e]) } return new a.prototype._init(f) }; a.prototype = { constructor: a, _init: function (e) { this.cf = e; this._setDOM(); if (!this.dom) { return false } e.initBefore && e.initBefore.call(this); this._bindEvent(); this.slide(); e.initAfter && e.initAfter.call(this, e.activeIndex); return this }, addSlideFns: function (e) { this.slideFns.push(e) }, slide: function () { if (!this.cf.slideAuto) { return this.slideTo() } var e = this, f = function () { e.timer && clearInterval(e.timer); e.timer = setInterval(function () { e.slideTo(e.activeIndex + 1) }, e.cf.delay) }; f(); c(e.dom.box).on("mouseover", function () { clearInterval(e.timer) }).on("mouseout", function () { f() }) }, slidePrev: function () { return this.slideTo(this.activeIndex - 1) }, slideNext: function () { return this.slideTo(this.activeIndex + 1) }, slideTo: function (f) { if (f === this.activeIndex) { return } var g = this, h = g.cf, i = g.activeIndex, e = g.scount; f = f === d ? i : f < 0 ? e - 1 : f > e - 1 ? 0 : f; g.oldIndex = i; g.activeIndex = f; h.slideBefore && h.slideBefore.call(g, f); g._sliding(); h.slideAfter && h.slideAfter.call(g, f); return this }, _sliding: function () { var h = this.cf.slideType, g = this._slideObjs, f = this.slideFns; g[h] && g[h].call(this); for (var e in f) { f[e].call(this, this.activeIndex) } }, _slideObjs: { left: function () { var e = this, f = e.cf; e.$scn.stop().animate({ left: -e.cnWidth * e.activeIndex }, f.speed, f.easing) }, top: function () { var e = this, f = e.cf; e.$scn.stop().animate({ top: -e.cnHeight * e.activeIndex }, f.speed, f.easing) }, fade: function () { var e = this, f = e.cf, g = e.$scns; g.eq(e.activeIndex).stop().show().css("z-index", 4).animate({ opacity: 1 }, f.speed, f.easing); g.eq(e.oldIndex).stop().css("z-index", 3).animate({ opacity: 0 }, f.speed, f.easing, function () { c(this).hide().css("z-index", 1) }) } }, _slideLayouts: { left: function () { var f = this, e = f.scn.style; e.width = (f.sWidth * f.scount) + "px"; e.left = "0px"; if (f.sWidth < f.cnWidth) { var g = Math.ceil(f.sWidth * f.scount / f.cnWidth); f.scount = f.sWidth * f.scount % f.cnWidth < f.sWidth ? g - 1 : g; f.cnWidth = f.sWidth * (Math.round(f.cnWidth / f.sWidth)) } }, top: function () { var f = this, e = f.scn.style; e.height = f.sHeight * f.scount + "px"; e.top = "0px"; if (f.sHeight < f.cnHeight) { var g = Math.ceil(f.sHeight * f.scount / f.cnHeight); f.scount = f.sHeight * f.scount % f.cnHeight < f.sHeight ? g - 1 : g; f.cnHeight = f.sHeight * (Math.round(f.cnHeight / f.sHeight)) } c.each(f.scns, function (h, j) { j.style.height = f.sHeight + "px"; j.style["float"] = "none" }) }, fade: function () { var e = this; c.each(e.scns, function (f, g) { var j = 0, h = 1; f === e.cf.activeIndex && (j = 1) && (h = 2); c(g).css({ opacity: j, position: "absolute", "z-index": h, left: 0, top: 0 }) }) } }, _setDOM: function () { if (this.dom) { return } var z = this, o = z.cf, l = o.idBox.nodeType ? o.idBox : c("#" + o.idBox)[0], y = function (E, C, i, D) { return E && c("#" + E)[0] || C && c("." + C, i)[0] || D && c(D, i)[0] }, A = y(o.idScn, o.clsScn, l, "ul"), x = A && c(A).children().toArray(); if (!l || !A || !x.length) { return } var j, t, u, q, r, n, B = [], k = o.slideType, p = c("img", A), m = l.offsetWidth, w = l.offsetHeight, g = scount = x.length, f = function (i) { return document.createElement(i || "div") }, v = function () { n = f(); n.style.overflow = "hidden"; n.innerHTML = "<p>" + B[0] + "</p>"; o.idText && (n.id = o.idText); o.clsText && (n.className = o.clsText); l.appendChild(n) }, e = function () { var E = "", C = o.eleNavChild; j = f(o.eleNav); o.clsNav && (j.className = o.clsNav); o.idNav && (j.id = o.idNav); for (var D = 0; D < scount; D++) { E += "<" + C + ' title="' + (D + 1) + '">' + (D + 1) + "</" + C + ">" } j.innerHTML = E; l.appendChild(j) }, h = function () { u = f(); u.className = o.clsPn; u.innerHTML = '<a href="javascript:;" class="' + o.clsPrev + '">' + o.prevText + '</a><a href="javascript:;" class="' + o.clsNext + '" >' + o.nextText + "</a>"; l.appendChild(u) }; c.extend(z, { scn: A, scns: x, $scn: c(A), $scns: c(x), count: g, scount: scount, slideFns: [], titles: B, cnWidth: m, cnHeight: w, sWidth: x[0].offsetWidth || m, sHeight: x[0].offsetHeight || w, activeIndex: o.activeIndex }); z._slideLayouts[k] && z._slideLayouts[k].call(this); c.each(x, function () { this.style.width = z.sWidth + "px" }); A.style.position = "relative"; if (o.isShowNav) { j = y(o.idNav, o.clsNav, l, "ol"); !j && e() } if (o.isShowText) { for (var s = 0; s < p.length; s++) { B[s] = p[s].title || "" } n = y(o.idText, o.clsText, l); !n && v() } if (o.isShowPn) { u = y(o.idPn, o.clsPn, l); !u && h(); q = c("." + o.clsPrev, u); r = c("." + o.clsNext, u) } z.dom = { box: l, scn: A, scns: x, nav: j, pn: u, prev: q, next: r, imgs: p, text: n }; return this }, _bindEvent: function () { var g = this, h = g.cf, i = g.dom, e = h.clsActive; if (h.isShowNav) { var f = c(i.nav).children(); f.eq(h.activeIndex).addClass(e); f.on(h.activeEvent, function () { g.slideTo(f.index(this)); return false }); g.slideFns.push(function (j) { f.eq(j).addClass(e).siblings().removeClass(e) }) } if (h.isShowPn) { c(i.prev).on("click", function () { g.slidePrev() }); c(i.next).on("click", function () { g.slidePrev() }) } if (h.isShowText && h.isRunText) { g.hText = i.text.offsetHeight; g.dom.textp = c("p", i.text)[0]; g.slideFns.push(function (l) { var j = c(i.text), k = h.speed / 2; j.stop().animate({ height: 0 }, k, h.easing, function () { j.stop().animate({ height: g.hText }, k, h.easing) }); g.dom.textp.innerHTML = g.titles[l] }) } } }; a.defaults = { idBox: null, idScn: null, idNav: null, idText: null, idPn: null, clsScn: "slider-scn", clsText: "slider-txt", clsNav: "slider-nav", clsPn: "slider-pn", clsPrev: "slider-prev", clsNext: "slider-next", clsActive: "active", eleNav: "ol", eleNavChild: "li", activeEvent: "mouseover", prevText: "", nextText: "", isShowText: false, isRunText: true, isShowPn: true, isShowNav: true, slideType: "left", slideAuto: true, activeIndex: 0, speed: 300, delay: 5000, easing: null, initBefore: null, initAfter: null, slideBefore: null, slideAfter: null }; a.prototype._init.prototype = a.prototype; b.ytSlider = a })(window, jQuery);
